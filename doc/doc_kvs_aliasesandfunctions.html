<html>
<head>
<title>KVS Functions and aliases</title>
<style type="text/css">
body {
 font-size: 10pt;
 margin-left: 8px;
 margin-right: 8px;
 margin-top: 6px;
 margin-bottom: 6px;
 font-family:Verdana,Helvetica,Arial;
}
table, td, tr {
 font-size: 10pt;
 font-family:Verdana,Helvetica,Arial;
 color: #3c3c3c;
}
td {
 padding: 6px;
}
a:link {
 text-decoration: none;
 color: #2883e2;
}
a:visited {
 text-decoration: none;
 color: #6856cc;
}
a:hover {
 text-decoration: underline;
 color: #1873d2;
}
a:active {
 text-decoration: underline;
 color: #1873d2;
}
.title-table-cell {
 border-top-left-radius: 5px;
 border-top-right-radius: 5px;
 background-color: #BEBEF0;
 background: linear-gradient(#B5E1FC,#4E94D2);
}
.title-text {
 font-family:Verdana,Helvetica,Arial;
 font-size: 18pt;
 font-weight: bold;
 padding-bottom: 3px;
 color: #ffffff;
 text-shadow: 2px 2px 2px rgba(88,88,88,1);
}
.title-secondary-text {
 font-family:Verdana,Helvetica,Arial;
 font-size: 11pt;
 padding-top: 3px;
 color: #d0d0d0;
 text-shadow: 1px 1px 1px rgba(88,88,88,1);
}
.subtitle-table-cell {
 background-color: #cccccc;
}
.subtitle-text {
 font-family:Verdana,Helvetica,Arial;
 font-size: 11pt;
 color: #000000;
 text-shadow: 1px 1px 1px rgba(110,110,110,1);
}
.subsubtitle-table-cell {
 background-color: #dadada;
}
.subsubtitle-text {
 font-family:Verdana,Helvetica,Arial;
 font-size: 10pt;
 color: #4e4e4e;
}
.syntax-text {
 font-family:"Lucida Console", Monaco, monospace, "Courier New";
 font-size: 10pt;
 font-weight: bold;
 white-space: pre;
 color: #800000;
}
.example-box {
 font-family:"Lucida Console", Monaco, monospace, "Courier New";
 font-size: 10pt;
 white-space: pre;
 background-color: #f5f5f5;
 border: 1px solid #d5d5d5;
 color: #800000;
 padding: 10px;
 margin-top: 6px;
 margin-bottom: 6px;
}
.example-box a:link {
 color: #600030;
}
.example-box a:visited {
 color: #600030;
}
.example-box a:hover {
 color: #ff0020;
}
.example-box a:active {
 color: #ff0020;
}
.comment-text {
 color: #578A57;
}
.comment-text a:link {
 color: #578A57;
}
.comment-text a:visited {
 color: #578A57;
}
.comment-text a:hover {
 color: #376A47;
}
.comment-text a:active {
 color: #376A47;
}
.example-paren {
 color: #8A7000;
}
.example-bracket {
 color: #9C7914;
}
.example-oper {
 color: #9C7914;
}
.example-variable {
 color: #AB6332;
}
.comment-text .example-variable {
 color: #578A57;
}
.comment-text .example-oper {
 color: #578A57;
}
.comment-text .example-paren {
 color: #578A57;
}
.comment-text .example-bracket {
 color: #578A57;
}
.switch-table {
 width: 100%;
 border-collapse: collapse;
}
.switch-title-table-cell {
 font-family:"Lucida Console", Monaco, monospace, "Courier New";
 font-size: 10pt;
 color: #670000;
 background-color: #e0e0e0;
}
.switch-body-table-cell {
}
.footer {
 border-top: 1px solid #a2a2a2;
 color: #a2a2a2;
 margin-top: 8px;
 padding-top: 4px;
 font-style: italic;
 font-size: 8pt;
}
</style>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
</head>
<body bgcolor="#FFFFFF" text="#000000">
<table width="100%" cellpadding="1" cellspacing="0" border="0">
 <tr>
  <td align="left" bgcolor="#FFFFFF">
    <a href="index.html"><img src="helplogoleft.png" iorder="0"></a>
  </td>
  <td align="right" bgcolor="#FFFFFF">
    <img src="helplogoright.png">
  </td>
 </tr>
</table>
<table width="100%" cellpadding="3" cellspacing="0" border="0">
  <tr>
    <td class='title-table-cell'>
      <div class='title-text'>KVS Functions and aliases</div>      <div class='title-secondary-text'>KVS Functions and aliases</div>    </td>
  </tr>
  <tr bgcolor="#EAEAEA">
    <td></td></tr><tr><td class="subtitle-table-cell"><div class="subtitle-text">Introduction</div></td></tr><tr><td bgcolor="#EAEAEA">
<p>
Since you're here, you should already have readed about the <a href="doc_kvs_basicconcepts.html">kvs basic concepts</a>
and have visited the <a href="doc_commands.html">command index</a>. If you feel ready to take the next step
then read on.
</p>
</td></tr><tr><td class="subtitle-table-cell"><div class="subtitle-text">Functions</div></td></tr><tr><td bgcolor="#EAEAEA"><br>
<p>
KVS has many internal <a href="doc_functions.html">functions</a> that can be used as command parameters.<br>
<b>All the function names start with a literal '$' character.</b><br>
<div class="example-box"><a href="cmd_echo.html">echo</a> This window caption is <a href="fnc_window.caption.html">$window.caption</a>
</div>
The <a href="fnc_window.caption.html">$window.caption</a> <a href="doc_functions.html">function</a>
is evaluated before the command executes,
and it is changed into the current window caption text.<br>
The <a href="doc_functions.html">functions</a> can be used also as switch parameters.<br>
<div class="example-box"><a href="cmd_echo.html">echo</a> -w = <a href="fnc_window.html">$window</a> This text will be surely \
&nbsp; &nbsp; printed in the current window
</div>
The -w switch allows to redirect the echo text to a specified window --- in this
case the one that you are typing in.<br>
<i>(Surprise: in this case the -w switch is useless,
since echo prints text to the current window by default...
but it will work correctly. :)</i>
</p>
<p>
Normal function names can be made of "anycase" letters, digits and underscores,
with the restriction that the first character is not a digit.<br>
Some kind of functions can contain a dot '.' character inside the name
and these are assumed to be module references (see <a href="doc_modules.html">the modules documentation</a>).<br>
</p>
<p>
By now we have seen only simple functions, but there's more...<br>
The functions can accept parameters; the general syntax for a function call is:<br>
<b>$&lt;function name&gt;['('&lt;parameter_list&gt;')']</b><br>
where &lt;parameter_list&gt; is a list of comma separated parameters,
eventually empty.
<div class="example-box"><a href="cmd_echo.html">echo</a> The word 'neural' is <a href="fnc_str.len.html">$str.len</a><span class="example-paren">(</span>neural<span class="example-paren">)</span> characters long
</div>
The function <a href="fnc_str.len.html">$str.len</a> accepts a single parameter and returns the
length in characters of the parameter string. The returned value is always
a string: in this case it can be also interpreted as a number.<br>
When passing an empty list you can avoid the parenthesis.
(And you have found the "simple" functions shown above).
So the followind two calls are equal:<br>
<div class="example-box"><a href="cmd_echo.html">echo</a> <a href="fnc_window.caption.html">$window.caption</a>
<a href="cmd_echo.html">echo</a> [fnc]$window.caption<span class="example-paren">()</span>[/fnc]
</div>
If you want to pass an "empty" string as the first parameter you have to use
the following syntax:<br>
<div class="example-box"><a href="cmd_echo.html">echo</a> <a href="fnc_str.len.html">$str.len</a><span class="example-paren">(</span>""<span class="example-paren">)</span>
</div>
Obviously a function is valid as a function parameter.<br>
<div class="example-box"><a href="cmd_echo.html">echo</a> <a href="fnc_str.len.html">$str.len</a><span class="example-paren">(</span><a href="fnc_window.caption.html">$window.caption</a><span class="example-paren">)</span>
</div>
If you want to place a literal '(' or ')' in the function parameters
you must escape it.
A special case for when you want to use 'matching' parentheses:
an opened '(' corresponds to a closed ')'.
In this case you can omit the 'escape' character.<br>
<div class="example-box"><a href="cmd_echo.html">echo</a> The length of '<span class="example-paren">(</span>a+b<span class="example-paren">)</span>' is : <a href="fnc_str.len.html">$str.len</a><span class="example-paren">(</span> <span class="example-paren">(</span>a+b<span class="example-paren">)</span> <span class="example-paren">)</span>
</div>
This is useful for algebraic and boolean expressions, like the ones
accepted by the special function $() (see next paragraphs).<br>
</p>
</td></tr><tr><td class="subtitle-table-cell"><div class="subtitle-text">Aliases</div></td></tr><tr><td bgcolor="#EAEAEA"><br>
An alias is a user defined command. It can be used to rename the builtin kvirc commands or functions,
to automate complex tasks or as a means for structured programming.
Aliases can be created or destroyed by using the scriptcenter (graphic interface)
or from the commandline (or script) by using the <a href="cmd_alias.html">alias</a> command.
Once created, an alias remains stored permanently in the KVIrc configuration files
until it is explicitly deleted.
A couple of examples will make the things clear.
join is a really commonly used command - it might be a good idea to rename it to
simply "j" .. just to type it faster.
Nothing easier in KVirc: just try this commandline:
<div class="example-box"><a href="cmd_alias.html">alias</a><span class="example-paren">(</span>j<span class="example-paren">)</span><span class="example-bracket">{</span> <a href="cmd_join.html">join</a> $0-; <span class="example-bracket">}</span>;
</div>
This will create the alias "j". From this moment you can use /j as if it was a normal command.
<div class="example-box">j #kvirc
</div>
You may have noticed the strange $0- function in the alias body - it stands for
"all parameters passed to the alias". This means that when you call
<div class="example-box">j #kvirc testpassword
</div>
then both the parameters (#kvirc and testpassword) are passed to the join command.
The $N functions are special functions that return the positional parameters passed
to the current script context. In an alias the script context is the script body and
it is the alias caller that generates the parameters.
$N (where N is a digit) returns the (N-1)-th positional parameter passed by the caller.
It returns the parameter numbered N-1 and not N since the parameters are indexed starting
from zero ($0 is the first parameter!).
$N-M returns the parameters from (N-1)-th to the (M-1)-th (a parameter range) and $N- returns
all the parameters from (N-1)-th to the last one. In the example above $0- stands for
all the parameters starting from the first one.
</p>
<p>
To remove an alias, use the alias command again with an empty body:
<div class="example-box"><a href="cmd_alias.html">alias</a><span class="example-paren">(</span>j<span class="example-paren">)</span><span class="example-bracket">{}</span>
</div>
This will remove the alias "j" defined above.
</p>
<p>
A common task in channel management is the kick & ban action.
You first ban a user from the channel and then eventually kick him
(obviously assuming that he is actually on the channel).
This involves using two commands - ban and then kick.
It could be a nice idea to have a single "kb" command to perform this action.
Well...easy:
<div class="example-box"><a href="cmd_alias.html">alias</a><span class="example-paren">(</span>kb<span class="example-paren">)</span><span class="example-bracket">{</span> <a href="cmd_ban.html">ban</a> $0; <a href="cmd_kick.html">kick</a> $0-; <span class="example-bracket">}</span>;
</div>
This adds the "kb" alias - it can be called as a normal command:
<div class="example-box">kb spammer You're not welcome here!
</div>
This will first execute "ban spammer" and then "kick spammer You're not welcome here".
Our kb is a really simple example... it doesn't check for the validity of the parameters -
the server will warn us if the parameters passed to kb were empty.
</p>
<p>
The alias can be modified at any time by reusing the alias command.
Let's make our "kb" a bit more intelligent and add a check for the parameters.
TIP: It is a good idea to write the following examples in a text file and then use /parse &lt;filename&gt; to execute it.
<div class="example-box"><a href="cmd_alias.html">alias</a><span class="example-paren">(</span>kb<span class="example-paren">)</span>
<span class="example-bracket">{</span>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="cmd_if.html">if</a><span class="example-paren">(</span>"$0" == ""<span class="example-paren">)</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="example-bracket">{</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="cmd_echo.html">echo</a> "Usage: /kb &lt;nickname&gt; &lt;kick reason&gt;"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="cmd_return.html">return</a>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="example-bracket">}</span>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="cmd_ban.html">ban</a> $0
&nbsp;&nbsp;&nbsp;&nbsp;<span class="example-variable">%reason</span> = $1-
&nbsp;&nbsp;&nbsp;&nbsp;<a href="cmd_if.html">if</a><span class="example-paren">(</span>"<span class="example-variable">%reason</span>" == ""<span class="example-paren">)</span><span class="example-variable">%reason</span> = "You're not welcome here!"
&nbsp;&nbsp;&nbsp;&nbsp;<a href="cmd_kick.html">kick</a> $0 <span class="example-variable">%reason</span>
<span class="example-bracket">}</span>
</div>
The example above will first check the validity of the &lt;nickname&gt; passed to kb -
if no nickname was passed, it will warn the user and stop.
The next step will be the "ban &lt;nickname&gt;" call. Another enchancement is the "default reason" -
we first assign the remaining parameters ($1- means "from $1 to the end") to a temporary variable,
and if the variable is empty, a default kick reason is assigned.
Finally the "kick &lt;nickname&gt; &lt;reason&gt;" will be executed.
Get used to looking at the single command documentation pages, they will give
you the hints necessary to fully understand the above piece of code.
</p>
<p>
Aliases can be used as a means for structured programming.
In large scripts you will SURELY have "common tasks" to perform (like having
specially-colored output or calculating a value from a set of other values)...
Aliases are the way of writing the common tasks - they are equivalent to the "procedures"
or "functions" in many high-level programming languages.
The alias as a procedure (subroutine or sub-task) has been shown in the "kb" example above -
it might be commonly called from more complex scripts or other aliases in the case that a
kick & ban action is needed.
</p>
<p>
Aliases can be used also as functions.
Assume that you often need to calculate the sum of three numbers - a function-alias is the way.
<div class="example-box"><a href="cmd_alias.html">alias</a><span class="example-paren">(</span>sum3<span class="example-paren">)</span><span class="example-bracket">{</span> <a href="cmd_return.html">return</a> $<span class="example-paren">(</span>$0 + $1 + $2<span class="example-paren">)</span>; <span class="example-bracket">}</span>;
</div>
This will add the alias "sum3" and make it available both as a command and a function.
The "return" command sets the return value of a sequence of commands
(an alias is a sequence of commands...remember ?) and terminates the execution (by returning
the control to the caller).
So return $($0 + $1 + $2); will set the return value of the alias to the value
computed by $($0 + $1 + $2), which is the sum of the first three parameters passed.
You will then use it in the following way:
<div class="example-box">...
<span class="example-variable">%myfirstsum</span> = $sum3<span class="example-paren">(</span><span class="example-variable">%somevalue</span>,<span class="example-variable">%someothervalue</span>,4<span class="example-paren">)</span>
<span class="example-variable">%anothersum</span> = $sum3<span class="example-paren">(</span>12,<span class="example-variable">%somevalue</span>,<span class="example-variable">%anothervalue</span><span class="example-paren">)</span>
...
</div>
Oops.. I've used some variables without actually explaining them... hehe.. please forgive me and read on.
This example is again really simple, but you might have more complex function-aliases.
The function-aliases are also normal aliases.... you can use it as a command:
<div class="example-box">/sum3 1 2 3
</div>
The above is a perfectly valid call.... however there will be no visible results
(because a command call implies ignoring the return value.
In fact there is no difference at all between function-aliases and normal-aliases -
the caller makes the difference. By calling an alias as a command, the return value
just disappears into hyperspace, however if you call an alias as a function, the return value
is propagated (and in fact "used").
There are some "nice" exceptions to this rule...but you don't need to care about it, for now.
If return is not called inside an alias body, the return value will be set to <a href="fnc_null.html">$null</a>.
</p>
<p>
Aliases can accept switches just like any other command. The <a href="fnc_sw.html">$sw</a> is there
exactly for that purpose. Check it out.
</p>
</td></tr><tr><td class="subtitle-table-cell"><div class="subtitle-text">Special functions</div></td></tr><tr><td bgcolor="#EAEAEA">
<p>
We have already seen the positional parameter functions.
The functions of type <b>$N[-[M]]</b> (where N and M are positive
numbers starting from 0 and N &lt; M) evaluate to the sequence of
<b>positional parameters</b> from Nth to Mth."<br>
If M is omitted, the function evaluate to the sequence of <b>positional
parameters</b> from Nth to the last one. If the whole -M block is omitted
the function evaluate to the Nth positional parameter.
We will discover more on the <b>positional parameters</b> when talking
of aliases and events.<br>
<div class="example-box">$0 evaluates to the 1st positional parameter
$0-4 evaluates to the parameters from first to 5th
$41- evaluates to the parameters from 41st to the last avaiable
</div>
The function <b>$#</b> evaluates to the number of positional parameters available.
The <b>positional parameter</b> functions do not accept parameters.<br>
The special function <b>$(&lt;expression&gt;)</b>, called the
"<a href="doc_expressioneval.html">expression evaluation identifier</a>", returns the result
of the evaluation of the &lt;expression&gt;. In previous versions of KVIrc this
function was called $calc().<br>
<div class="example-box"><a href="cmd_echo.html">echo</a> $<span class="example-paren">(</span>2 + <span class="example-paren">(</span>3 ^ 7<span class="example-paren">)</span> &lt;= 1 * <span class="example-paren">(</span>3 && 2<span class="example-paren">))</span>
</div>
The special function <b>${&lt;command sequence&gt;}</b> evaluates to the
return value of the &lt;command sequence&gt;.<br>
The special function <b>$$</b> evaluates to the current object id,
but it is too early to explain it here...<br>
</td>
  </tr>
</table>
<hr><a href="index.html">Index</a>, <a href="doc_language_index_all.html">Language Overview</a>
<div class='footer'>KVIrc 4.3.2.git-5292-gb397f4d Documentation - generated by universal at Wed Sep  9 13:23:28 2015</div>
</body>
</html>
